{"ast":null,"code":"import _regeneratorRuntime from\"D:/finalYear/frontend/ecommerce_gui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/finalYear/frontend/ecommerce_gui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import reducer from'../reducers/auth';import Cookies from'js-cookie';import axios from'axios';import{LOGIN_SUCCESS,LOGIN_FAIL,USER_LOADED_SUCCESS,USER_LOADED_FAIL,AUTHENTICATED_SUCCESS,AUTHENTICATED_FAIL,LOGOUT,PASSWORD_RESET_SUCCESS,PASSWORD_RESET_FAIL,PASSWORD_RESET_CONFIRM_SUCCESS,PASSWORD_RESET_CONFIRM_FAIL}from'./actionsTypes';export var checkAuthenticated=function checkAuthenticated(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!localStorage.getItem('access')){_context.next=16;break;}config={headers:{'Content-Type':'application/json','Accept':'application/json'}};body=JSON.stringify({token:localStorage.getItem('access')});_context.prev=3;_context.next=6;return axios.post(\"http://localhost:8000/auth/jwt/verify/\",body,config);case 6:res=_context.sent;console.log(\"works2\");if(res.data.code!=='token_not_valid'){dispatch({type:AUTHENTICATED_SUCCESS});}else{dispatch({type:AUTHENTICATED_FAIL});}_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](3);dispatch({type:AUTHENTICATED_FAIL});case 14:_context.next=17;break;case 16:dispatch({type:AUTHENTICATED_FAIL});case 17:case\"end\":return _context.stop();}}},_callee,null,[[3,11]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var load_user=function load_user(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(\"works2\");if(!localStorage.getItem('access')){_context2.next=15;break;}config={headers:{'Content-Type':'application/json','Authorization':\"JWT \".concat(localStorage.getItem('access')),'Accept':'application/json'}};_context2.prev=3;_context2.next=6;return axios.get(\"http://localhost:8000/auth/users/me/\",config);case 6:res=_context2.sent;dispatch({type:USER_LOADED_SUCCESS,payload:res.data});_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](3);dispatch({type:USER_LOADED_FAIL});case 13:_context2.next=16;break;case 15:dispatch({type:USER_LOADED_FAIL});case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[3,10]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var login=function login(email,password){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email,password:password});_context3.prev=2;_context3.next=5;return axios.post(\"http://localhost:8000/auth/jwt/create/\",body,config);case 5:res=_context3.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});dispatch(load_user());_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](2);dispatch({type:LOGIN_FAIL});case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[2,10]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var logout=function logout(){return function(dispatch){dispatch({type:LOGOUT});};};export var reset_password=function reset_password(email){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var config,body;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email});_context4.prev=2;_context4.next=5;return axios.post(\"http://localhost:8000/auth/users/reset_password/\",body,config);case 5:dispatch({type:PASSWORD_RESET_SUCCESS});_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](2);dispatch({type:PASSWORD_RESET_FAIL});case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[2,8]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var reset_password_confirm=function reset_password_confirm(uid,token,new_password,re_new_password){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var config,body;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({uid:uid,token:token,new_password:new_password,re_new_password:re_new_password});_context5.prev=2;_context5.next=5;return axios.post(\"http://localhost:8000/auth/users/reset_password_confirm/\",body,config);case 5:dispatch({type:PASSWORD_RESET_CONFIRM_SUCCESS});_context5.next=11;break;case 8:_context5.prev=8;_context5.t0=_context5[\"catch\"](2);dispatch({type:PASSWORD_RESET_CONFIRM_FAIL});case 11:case\"end\":return _context5.stop();}}},_callee5,null,[[2,8]]);}));return function(_x5){return _ref5.apply(this,arguments);};}();};","map":{"version":3,"sources":["D:/finalYear/frontend/ecommerce_gui/src/actions/auth.js"],"names":["reducer","Cookies","axios","LOGIN_SUCCESS","LOGIN_FAIL","USER_LOADED_SUCCESS","USER_LOADED_FAIL","AUTHENTICATED_SUCCESS","AUTHENTICATED_FAIL","LOGOUT","PASSWORD_RESET_SUCCESS","PASSWORD_RESET_FAIL","PASSWORD_RESET_CONFIRM_SUCCESS","PASSWORD_RESET_CONFIRM_FAIL","checkAuthenticated","dispatch","localStorage","getItem","config","headers","body","JSON","stringify","token","post","res","console","log","data","code","type","load_user","get","payload","login","email","password","logout","reset_password","reset_password_confirm","uid","new_password","re_new_password"],"mappings":"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","sourcesContent":["import reducer from '../reducers/auth'\r\nimport Cookies from 'js-cookie';\r\nimport axios from 'axios';\r\nimport { LOGIN_SUCCESS , LOGIN_FAIL, USER_LOADED_SUCCESS ,USER_LOADED_FAIL,AUTHENTICATED_SUCCESS,\r\n    AUTHENTICATED_FAIL, LOGOUT,PASSWORD_RESET_SUCCESS,PASSWORD_RESET_FAIL,PASSWORD_RESET_CONFIRM_SUCCESS,   \r\n    PASSWORD_RESET_CONFIRM_FAIL } from './actionsTypes';\r\n\r\n\r\nexport const checkAuthenticated = () => async dispatch => {\r\n        if (localStorage.getItem('access')) {\r\n            const config = {\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Accept': 'application/json'\r\n                }\r\n            }; \r\n    \r\n            const body = JSON.stringify({ token: localStorage.getItem('access') });\r\n    \r\n            try {\r\n                const res = await axios.post(`http://localhost:8000/auth/jwt/verify/`, body, config)\r\n                console.log(\"works2\")\r\n    \r\n                if (res.data.code !== 'token_not_valid') {\r\n                    dispatch({\r\n                        type: AUTHENTICATED_SUCCESS\r\n                    });\r\n                } else {\r\n                    dispatch({\r\n                        type: AUTHENTICATED_FAIL\r\n                    });\r\n                }\r\n            } catch (err) {\r\n                dispatch({\r\n                    type: AUTHENTICATED_FAIL\r\n                });\r\n            }\r\n    \r\n        } else {\r\n            dispatch({\r\n                type: AUTHENTICATED_FAIL\r\n            });\r\n        }\r\n};  \r\n\r\nexport const load_user = () => async dispatch => {\r\n    console.log(\"works2\")\r\n    if (localStorage.getItem('access')) {\r\n        const config = {\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `JWT ${localStorage.getItem('access')}`,\r\n                'Accept': 'application/json'\r\n            }\r\n            \r\n        }; \r\n\r\n        try {\r\n            const res = await axios.get(`http://localhost:8000/auth/users/me/`, config);\r\n    \r\n            dispatch({\r\n                type: USER_LOADED_SUCCESS,\r\n                payload: res.data\r\n            });\r\n        } catch (err) {\r\n            dispatch({\r\n                type: USER_LOADED_FAIL\r\n            });\r\n        }\r\n    } else {\r\n        dispatch({\r\n            type: USER_LOADED_FAIL\r\n        });\r\n    }\r\n};\r\n\r\nexport const login = (email, password) => async dispatch => {\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    };\r\n\r\n    const body = JSON.stringify({ email, password });\r\n\r\n    try {\r\n        const res = await axios.post(`http://localhost:8000/auth/jwt/create/`, body, config);\r\n\r\n        dispatch({\r\n            type: LOGIN_SUCCESS,\r\n            payload: res.data\r\n        });\r\n\r\n        dispatch(load_user());\r\n    } catch (err) {\r\n        dispatch({\r\n            type: LOGIN_FAIL\r\n        })\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\nexport const logout = () => dispatch => {\r\n    dispatch({\r\n        type: LOGOUT\r\n    });\r\n};\r\n\r\nexport const reset_password = (email) => async dispatch => {\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    };\r\n\r\n    const body = JSON.stringify({ email });\r\n\r\n    try {\r\n        await axios.post(`http://localhost:8000/auth/users/reset_password/`, body, config);\r\n\r\n        dispatch({\r\n            type: PASSWORD_RESET_SUCCESS\r\n        });\r\n    } catch (err) {\r\n        dispatch({\r\n            type: PASSWORD_RESET_FAIL\r\n        });\r\n    }\r\n};\r\n\r\n\r\nexport const reset_password_confirm = (uid, token, new_password, re_new_password) => async dispatch => {\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    };\r\n\r\n    const body = JSON.stringify({ uid, token, new_password, re_new_password });\r\n\r\n    try {\r\n        await axios.post(`http://localhost:8000/auth/users/reset_password_confirm/`, body, config);\r\n\r\n        dispatch({\r\n            type: PASSWORD_RESET_CONFIRM_SUCCESS\r\n        });\r\n    } catch (err) {\r\n        dispatch({\r\n            type: PASSWORD_RESET_CONFIRM_FAIL\r\n        });\r\n    }\r\n};\r\n\r\n"]},"metadata":{},"sourceType":"module"}